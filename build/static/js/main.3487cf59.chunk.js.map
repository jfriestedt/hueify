{"version":3,"sources":["reducers/root_reducer.js","reducers/tokens.js","reducers/spotify_player_mount_status.js","reducers/spotify_player_state.js","reducers/hue_bridge_ips.js","reducers/palette.js","components/album_art.js","components/color_extractor.js","components/gradient_mask.js","components/hue_interface.js","components/login_prompt.js","components/player_interface.js","components/track_info.js","App.js","serviceWorker.js","index.js","store.js"],"names":["combineReducers","tokens","state","type","payload","assign","refreshToken","spotifyPlayerMountStatus","spotifyPlayerState","playerState","bridgeIPs","palette","connect","image","chain","get","sortBy","Math","abs","width","first","value","albumArtUrl","url","glowColor","length","nth","getHex","style","boxShadow","height","opacity","transition","alt","src","decoding","ColorExtractor","paletteContainerStyleBase","display","alignItems","justifyContent","margin","paletteStyleBase","boxSizing","lineHeight","swatchStyleBase","flexGrow","fontSize","map","swatch","sort","join","nextProps","this","props","getPaletteID","keys","swatchName","assignIn","name","filter","getRgb","sum","Vibrant","filters","getPalette","err","dispatch","sortPalette","prevProps","generateNewPalette","colorHex","backgroundColor","key","styleBase","swatches","renderSwatch","id","background","borderLightHex","borderDarkHex","isEmpty","renderPalette","Component","position","zIndex","HueInterface","fetch","response","ok","json","bridges","bridge","internalipaddress","forEach","ip","method","body","JSON","stringify","devicetype","then","parsedResponse","console","log","attemptUserCreations","pollingTimeout","setInterval","beginPolling","loggedIn","href","className","PlayerInterface","mounting","error","window","onSpotifyWebPlaybackSDKReady","setState","player","Spotify","Player","getOAuthToken","cb","refreshTokenUrl","access_token","addListener","message","device_id","URLSearchParams","location","search","prevState","spotifyPlayerMountReady","mountPlayer","loading","spotifyPlayerMounted","CSSTransition","in","exit","timeout","classNames","unmountOnExit","renderConnectPrompt","Helmet","renderDeviceInfoLoading","renderDeviceInfo","currentTrack","title","artists","App","browserInfo","Bowser","parse","navigator","userAgent","isBrowserSupported","mainStyleBase","flexDirection","mainStyle","bgHex","textHex","color","renderApp","renderBrowserNotSupported","last","Boolean","hostname","match","ReactDOM","render","store","createStore","rootReducer","composeWithDevTools","applyMiddleware","thunk","configureStore","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.3487cf59.chunk.js","sourcesContent":["import { combineReducers } from 'redux';\nimport tokens from './tokens';\nimport spotifyPlayerMountStatus from './spotify_player_mount_status'\nimport spotifyPlayerState from './spotify_player_state'\nimport bridgeIPs from './hue_bridge_ips'\nimport palette from './palette'\n\nexport default combineReducers({\n  tokens,\n  spotifyPlayerMountStatus,\n  spotifyPlayerState,\n  bridgeIPs,\n  palette\n});\n","import { assign } from 'lodash';\n\nexport default (state = {}, { type, payload }) => {\n  switch (type) {\n    case 'REGISTER_TOKENS':\n      return assign({}, state, { refreshToken: payload });\n    default:\n      return state;\n  }\n}\n","export default (state = 'NOT_READY', { type }) => {\n  switch (type) {\n    case 'SPOTIFY_PLAYER_MOUNT_READY':\n    case 'SPOTIFY_PLAYER_MOUNTED':\n      return type\n    default:\n      return state;\n  }\n}\n","export default (state = {}, { type, state: playerState }) => {\n  switch (type) {\n    case 'SPOTIFY_PLAYER_STATE_CHANGED':\n      return playerState;\n    default:\n      return state;\n  }\n}\n","export default (state = [], { type, payload }) => {\n  switch (type) {\n    case 'HUE_BRIDGES_DISCOVERED':\n      return payload\n    default:\n      return state;\n  }\n}\n","export default (state = [], { type, payload }) => {\n  switch (type) {\n    case 'NEW_PALETTE':\n      return payload;\n    case 'NO_PALETTE':\n      return {}\n    default:\n      return state;\n  }\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { chain, nth } from 'lodash';\n\nconst AlbumArt = ({ albumArtUrl, glowColor }) => {\n  const style = {\n    boxShadow: `0 0 100px ${glowColor}`,\n    height: '300px',\n    opacity: albumArtUrl ? 1 : 0,\n    transition: 'box-shadow 200ms ease, opacity 200ms ease 300ms',\n    width: '300px'\n  }\n\n  return <div style={style}>\n    {albumArtUrl && <img alt='album art'\n                         src={albumArtUrl}\n                         height='300'\n                         width='300'\n                         decoding='sync' />}\n  </div>\n}\n\nconst mapStateToProps = ({ spotifyPlayerState, palette }) => {\n  const image = chain(spotifyPlayerState)\n    .get(['track_window', 'current_track', 'album', 'images'])\n    // TODO: Abstract this to a helper fn\n    .sortBy((image) => Math.abs(image.width - 300))\n    .first()\n    .value();\n\n  return {\n    albumArtUrl: (image && image.url) || '',\n    glowColor: (\n      palette && palette.length > 1 &&\n      nth(palette, ((palette.length / 2) - 1)).getHex()\n    ) || '#FFFFFF'\n  }\n}\n\nexport default connect(mapStateToProps)(AlbumArt)\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { assign, assignIn, chain, isEmpty, nth, sum } from 'lodash'\nimport * as Vibrant from 'node-vibrant'\n\n// TODO: color extraction should be handled by middleware. This component\n// should just be palette rendering.\n\nclass ColorExtractor extends Component {\n  constructor ({ palette }) {\n    super();\n    this.paletteContainerStyleBase = {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: '50px',\n      margin: '20px 0',\n      transition: 'opacity 200ms ease 400ms',\n      width: '300px'\n    }\n    this.paletteStyleBase = {\n      boxSizing: 'border-box',\n      display: 'flex',\n      height: 'calc(100% - 2px)',\n      width: 'calc(100% - 2px)',\n      lineHeight: '0'\n    }\n    this.swatchStyleBase = {\n      flexGrow: '1',\n      fontSize: '6px',\n      height: '100%',\n      transition: 'background-color 200ms ease'\n    }\n  }\n\n  getPaletteID (palette) {\n    return chain(palette)\n      .map((swatch) => swatch.getHex())\n      .sort()\n      .join('_')\n      .value();\n  }\n\n  shouldComponentUpdate (nextProps) {\n    return (\n      nextProps.albumArtUrl !== this.props.albumArtUrl ||\n      (\n        this.getPaletteID(nextProps.palette) !==\n        this.getPaletteID(this.props.palette)\n      )\n    )\n  }\n\n  sortPalette (palette) {\n    return chain(palette)\n      .keys()\n      .map((swatchName) => {\n        return assignIn({}, palette[swatchName], { name: swatchName })\n      })\n      .filter((swatch) => swatch.getRgb)\n      .sortBy((swatch) => sum(swatch.getRgb()))\n      .value();\n  }\n\n  generateNewPalette () {\n    const vib = new Vibrant(this.props.albumArtUrl, {\n      filters: []\n    });\n\n    vib.getPalette((err, palette) => {\n      this.props.dispatch({\n        type: 'NEW_PALETTE',\n        payload: this.sortPalette(palette)\n      });\n    });\n  }\n\n  componentDidUpdate (prevProps) {\n    if (prevProps.albumArtUrl && !this.props.albumArtUrl) {\n      this.props.dispatch({ type: 'NO_PALETTE' });\n    } else if (prevProps.albumArtUrl !== this.props.albumArtUrl) {\n      this.generateNewPalette();\n    }\n  }\n\n  renderSwatch (swatch) {\n    const colorHex = swatch.getHex(),\n          style = assign({}, this.swatchStyleBase, { backgroundColor: colorHex })\n\n    return <div key={swatch.name} style={style}></div>;\n  }\n\n  renderPalette (palette, styleBase) {\n    const swatches = chain(palette)\n      .map((swatch) => this.renderSwatch(swatch))\n      .value();\n\n    return <div id='palette' style={styleBase}>{swatches}</div>;\n  }\n\n  render () {\n    let background, borderLightHex, borderDarkHex;\n    if (!isEmpty(this.props.palette)) {\n      // TODO: what about for palettes with less than 6 swatches?\n      borderLightHex = nth(this.props.palette, 3).getHex();\n      borderDarkHex = nth(this.props.palette, 2).getHex();\n      background =\n        `linear-gradient(to right, ${borderLightHex}, ${borderDarkHex})`\n    }\n    const style = assign({}, this.paletteContainerStyleBase, {\n      background,\n      opacity: isEmpty(this.props.palette) ? 0 : 1,\n    })\n\n    return <div style={style}>\n      {!isEmpty(this.props.palette) && this.renderPalette(\n        this.props.palette,\n        this.paletteStyleBase\n      )}\n    </div>\n  }\n}\n\nconst mapStateToProps = ({ spotifyPlayerState, palette }) => {\n  const image = chain(spotifyPlayerState)\n    .get(['track_window', 'current_track', 'album', 'images'])\n    // TODO: Abstract this to a helper fn\n    .sortBy((image) => Math.abs(image.width - 64))\n    .first()\n    .value();\n\n  return {\n    albumArtUrl: image ? image.url : '',\n    palette\n  }\n}\n\nexport default connect(mapStateToProps)(ColorExtractor);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { assign, first, isEmpty } from 'lodash';\n\nconst GradientMask = ({ colorHex }) => {\n  const styleBase = {\n    height: '100%',\n    position: 'absolute',\n    width: '100%',\n    zIndex: -1\n  }\n\n  return <div style={assign({}, styleBase, {\n    background: (\n      colorHex &&\n      `linear-gradient(to top, ${colorHex}, rgba(0, 0, 0, 0))`\n    )\n  })} />\n}\n\nconst mapStateToProps = ({ palette }) => {\n  return { colorHex: !isEmpty(palette) && first(palette).getHex() }\n}\n\nexport default connect(mapStateToProps)(GradientMask)\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { get, isEmpty } from 'lodash';\nimport '../App.scss'\n\nclass HueInterface extends Component {\n\n  async componentDidMount () {\n    const response = await fetch('https://discovery.meethue.com');\n    if (response.ok) {\n      const bridges = await response.json();\n      if (!isEmpty(bridges)) {\n        this.props.dispatch({\n          type: 'HUE_BRIDGES_DISCOVERED',\n          payload: bridges.map((bridge) => bridge.internalipaddress)\n        })\n      }\n    }\n  }\n\n  // TODO: this should be a thunk action (I think?)\n  attemptUserCreations () {\n    this.props.bridgeIPs.forEach((ip) => {\n      return fetch(`http://${ip}/api`, {\n        method: 'POST',\n        body: JSON.stringify({ devicetype: 'hueify#hueify' })\n      }).then((response) => {\n        if (response.ok) {\n          return response.json().then((parsedResponse) => {\n            if (get(parsedResponse, [0, 'success'])) {\n              console.log('success!')\n            }\n          })\n        }\n      })\n    });\n  }\n\n  beginPolling () {\n    this.attemptUserCreations();\n    this.pollingTimeout = setInterval(\n      (() => this.attemptUserCreations()),\n      1000\n    );\n  }\n\n  componentDidUpdate (prevProps) {\n    if (isEmpty(prevProps.bridgeIPs) && !isEmpty(this.props.bridgeIPs)) {\n      this.beginPolling();\n    }\n  }\n\n  render () {\n    return isEmpty(this.props.bridgeIPs) ?\n      null :\n      <ul style={{ margin: '20px', position: 'absolute' }}>\n        <h6>Philips Hue IPs:</h6>\n        {this.props.bridgeIPs.map((ip) => {\n          return <li key={ip}>{ip}</li>\n        })}\n      </ul>\n  }\n}\n\nconst mapStateToProps = ({ bridgeIPs }) => {\n  return { bridgeIPs };\n}\n\nexport default connect(mapStateToProps)(HueInterface);\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nconst LoginPrompt = ({ loggedIn }) => {\n  const style = {\n    position: 'absolute',\n    zIndex: 1\n  }\n\n  return !loggedIn && <a href='/login' className='button' style={style}>\n    Log in to Spotify\n  </a>\n}\n\nconst mapStateToProps = (state) => {\n  const { tokens: { refreshToken } } = state\n  return { loggedIn: !!refreshToken }\n}\n\nexport default connect(mapStateToProps)(LoginPrompt);\n","import React, { Component } from 'react';\nimport { Helmet } from 'react-helmet';\nimport { connect } from 'react-redux';\nimport { isEmpty } from 'lodash';\nimport { CSSTransition } from 'react-transition-group';\nimport '../App.scss'\n\nclass PlayerInterface extends Component {\n  constructor () {\n    super();\n\n    this.state = { mounting: false, error: null }\n    window.onSpotifyWebPlaybackSDKReady = () => {\n      this.props.dispatch({ type: 'SPOTIFY_PLAYER_MOUNT_READY' });\n    };\n  }\n\n  mountPlayer () {\n    this.setState({ mounting: true })\n\n    const player = new window.Spotify.Player({\n      name: '_*_HUEIFY_*_',\n      getOAuthToken: (cb) => {\n        const refreshTokenUrl =\n          `/refresh_token?refresh_token=${this.props.refreshToken}`\n        fetch(refreshTokenUrl)\n          .then((response) => response.json())\n          .then(({ access_token }) => cb(access_token))\n      }\n    });\n\n    // Error handling\n    player.addListener('initialization_error', ({ message }) => {\n      this.setState({ error: message })\n      console.error(message);\n    });\n    player.addListener('authentication_error', ({ message }) => {\n      this.setState({ error: message })\n      console.error(message);\n    });\n    player.addListener('account_error', ({ message }) => {\n      this.setState({ error: message })\n      console.error(message);\n    });\n    player.addListener('playback_error', ({ message }) => {\n      this.setState({ error: message })\n      console.error(message);\n    });\n\n    // Playback status updates\n    player.addListener('player_state_changed', (state) => {\n      this.props.dispatch({ type: 'SPOTIFY_PLAYER_STATE_CHANGED', state });\n    });\n\n    // Ready\n    console.log('player exists: ' + !!player)\n    console.log('adding ready listener')\n    player.addListener('ready', ({ device_id }) => {\n      console.log('Ready with Device ID', device_id);\n      this.props.dispatch({ type: 'SPOTIFY_PLAYER_MOUNTED' })\n      this.setState({ mounting: false })\n    });\n\n    // Not Ready\n    player.addListener('not_ready', ({ device_id }) => {\n      console.log('Device ID has gone offline', device_id);\n    });\n\n    // Connect to the player!\n    player.connect();\n  }\n\n  componentDidMount() {\n    const urlParams = new URLSearchParams(window.location.search),\n          refreshToken = urlParams.get('refresh_token');\n    if (refreshToken) {\n      this.props.dispatch({ type: 'REGISTER_TOKENS', payload: refreshToken })\n    }\n  }\n\n  componentDidUpdate (prevProps, prevState) {\n    if (\n      this.props.refreshToken &&\n      this.props.spotifyPlayerMountReady &&\n      !this.state.mounting\n    ) {\n      console.log('mounting player')\n      this.mountPlayer();\n    }\n  }\n\n  renderDeviceInfoLoading () {\n    if (this.state.error) {\n      return <h4 className='error'>{this.state.error}</h4>\n    } else {\n      const loading = (\n        this.props.refreshToken &&\n        this.props.spotifyPlayerMountReady &&\n        !this.props.spotifyPlayerMounted\n      )\n      return <CSSTransition in={loading}\n                            exit={false}\n                            timeout={200}\n                            classNames='device-info'\n                            unmountOnExit >\n        <div>\n          <h4>Connecting to Spotify</h4>\n          <h6>This could take a minute...</h6>\n        </div>\n      </CSSTransition>\n    }\n\n  }\n\n  renderConnectPrompt () {\n    return isEmpty(this.props.spotifyPlayerState) ?\n      <div>\n        <h4>Connect to device:</h4>\n        <h4><strong>_*_HUEIFY_*_</strong></h4>\n      </div> :\n      null\n  }\n\n  renderDeviceInfo () {\n    return <CSSTransition in={this.props.spotifyPlayerMounted}\n                          timeout={200}\n                          classNames='device-info'\n                          unmountOnExit >\n        <div>\n          {this.renderConnectPrompt()}\n        </div>\n      </CSSTransition>\n  }\n\n  render () {\n    return <div style={{ position: 'absolute' }}>\n      <Helmet>\n        <script src=\"https://sdk.scdn.co/spotify-player.js\"></script>\n      </Helmet>\n      {this.renderDeviceInfoLoading()}\n      {this.renderDeviceInfo()}\n    </div>\n  }\n}\n\nconst mapStateToProps = ({\n  tokens: { refreshToken },\n  spotifyPlayerMountStatus,\n  spotifyPlayerState\n }) => {\n  return {\n    refreshToken,\n    spotifyPlayerState,\n    spotifyPlayerMountReady: spotifyPlayerMountStatus === 'SPOTIFY_PLAYER_MOUNT_READY',\n    spotifyPlayerMounted: spotifyPlayerMountStatus === 'SPOTIFY_PLAYER_MOUNTED',\n  }\n}\n\nexport default connect(mapStateToProps)(PlayerInterface);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { chain, get } from 'lodash';\n\nconst TrackInfo = ({ title, artists }) => {\n  return <div id='track-info' style={{\n    opacity: (title && artists) ? 1 : 0,\n    transition: 'opacity 200ms ease 500ms',\n    width: '300px'\n  }}>\n    <h5><strong>{title ? title : ''}</strong></h5>\n    <h6 style={{ fontSize: '14px' }}>\n      {artists ? artists : ''}\n    </h6>\n  </div>\n}\n\nconst mapStateToProps = ({ spotifyPlayerState }) => {\n  const currentTrack = get(spotifyPlayerState, [\n    'track_window',\n    'current_track'\n  ]);\n\n  return {\n    title: get(currentTrack, 'name'),\n    artists: chain(get(currentTrack, 'artists') || [])\n      .map('name')\n      .join(', ')\n      .value()\n  }\n}\n\nexport default connect(mapStateToProps)(TrackInfo)\n","import Bowser from 'bowser';\nimport { assign, first, get, isEmpty, last, nth } from 'lodash';\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\n\nimport './App.scss'\n\nimport AlbumArt from './components/album_art'\nimport ColorExtractor from './components/color_extractor'\nimport GradientMask from './components/gradient_mask'\nimport HueInterface from './components/hue_interface'\nimport LoginPrompt from './components/login_prompt'\nimport PlayerInterface from './components/player_interface'\nimport TrackInfo from './components/track_info'\n\nclass App extends Component {\n  constructor () {\n    super();\n    const browserInfo = Bowser.parse(window.navigator.userAgent);\n    this.isBrowserSupported =\n      get(browserInfo, ['platform', 'type']) === 'desktop';\n\n    this.mainStyleBase = {\n      alignItems: 'center',\n      display: 'flex',\n      flexDirection: 'column',\n      height: '100%',\n      justifyContent: 'center',\n      position: 'absolute',\n      transition: 'background-color 200ms ease, color 200ms ease',\n      width: '100%',\n      zIndex: -2\n    }\n  }\n\n  renderBrowserNotSupported () {\n    return <div style={this.mainStyle}>\n      <h4 className='error'>\n        Sorry homie, Hueify only works on Desktop browsers. :'(\n      </h4>\n    </div>\n  }\n\n  renderApp () {\n    const { bgHex, textHex } = this.props,\n          style = assign({}, this.mainStyleBase, {\n      backgroundColor: bgHex,\n      color: textHex\n    });\n\n    return <div>\n      <HueInterface />\n      <div style={style}>\n        <LoginPrompt />\n        <AlbumArt />\n        <ColorExtractor />\n        <TrackInfo />\n        <PlayerInterface />\n        <GradientMask />\n      </div>\n    </div>\n  }\n\n  render () {\n    return <div className='App'>\n      {this.isBrowserSupported ?\n        this.renderApp() :\n        this.renderBrowserNotSupported()}\n    </div>\n  }\n}\n\nconst mapStateToProps = ({ palette }) => {\n  let textHex, bgHex;\n  if (!isEmpty(palette)) {\n    bgHex = nth(palette, 1).getHex();\n    textHex = palette.length === 1 ? '#FFFFFF' : last(palette).getHex();\n  }\n\n  return { bgHex, textHex }\n}\n\nexport default connect(mapStateToProps)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport configureStore from './store';\n\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <Provider store={configureStore()}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import { createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport rootReducer from './reducers/root_reducer';\nimport { composeWithDevTools } from 'redux-devtools-extension';\n\nexport default function configureStore (initialState = {}) {\n  return createStore(\n    rootReducer,\n    composeWithDevTools(applyMiddleware(thunk))\n  );\n}\n"],"sourceRoot":""}